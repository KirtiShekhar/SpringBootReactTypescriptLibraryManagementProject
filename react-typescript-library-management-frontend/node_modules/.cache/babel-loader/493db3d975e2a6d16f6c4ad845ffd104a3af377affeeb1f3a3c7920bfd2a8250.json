{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { sessionHistory } from \"../commons/history\";\nimport { clearCurrentUser } from \"../redux_reducers_actions/actions_auth/user.actions\";\nimport appStore from \"../redux_reducers_actions/allReducers\";\nimport { useSelector } from \"react-redux\";\nexport const AuthHeader = () => {\n  _s();\n  const currentSignInUser = useSelector(state => state.user);\n  return {\n    \"Content-Type\": \"application/json\",\n    Authorization: \"Bearer \" + (currentSignInUser === null || currentSignInUser === void 0 ? void 0 : currentSignInUser.jwtAccessToken)\n  };\n};\n_s(AuthHeader, \"FB+1eF0s480A5I3xR3k7oyJRicM=\", false, function () {\n  return [useSelector];\n});\n_c = AuthHeader;\nlet action;\nexport function handleResponseWithLoginCheck() {\n  var _s2 = $RefreshSig$();\n  _s2(axios.interceptors.response.use(response => response, _s2(error => {\n    var _error$response;\n    _s2();\n    const currentUser = useSelector(state => state.user);\n    const isSignedIn = currentUser === null || currentUser === void 0 ? void 0 : currentUser.jwtAccessToken;\n    const status = error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status;\n    if (isSignedIn && [401, 403].includes(status)) {\n      appStore.dispatch(clearCurrentUser());\n      sessionHistory.push(\"/login\");\n    }\n    return Promise.reject(error);\n  }, \"lZdPyK/MobwtETtTACdKAch84Kw=\", false, function () {\n    return [useSelector];\n  })), \"lZdPyK/MobwtETtTACdKAch84Kw=\", false, function () {\n    return [useSelector];\n  });\n}\nvar _c;\n$RefreshReg$(_c, \"AuthHeader\");","map":{"version":3,"names":["axios","sessionHistory","clearCurrentUser","appStore","useSelector","AuthHeader","currentSignInUser","state","user","Authorization","jwtAccessToken","action","handleResponseWithLoginCheck","interceptors","response","use","error","currentUser","isSignedIn","status","includes","dispatch","push","Promise","reject"],"sources":["D:/ReactProjects/react-typescript-library-management/src/services/base.service.ts"],"sourcesContent":["import axios from \"axios\";\r\nimport { sessionHistory } from \"../commons/history\";\r\nimport {\r\n  UserActions,\r\n  clearCurrentUser,\r\n} from \"../redux_reducers_actions/actions_auth/user.actions\";\r\nimport appStore from \"../redux_reducers_actions/allReducers\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nexport const AuthHeader = () => {\r\n  const currentSignInUser = useSelector((state: any) => state.user);\r\n\r\n  return {\r\n    \"Content-Type\": \"application/json\",\r\n    Authorization: \"Bearer \" + currentSignInUser?.jwtAccessToken,\r\n  };\r\n};\r\n\r\nlet action: UserActions;\r\n\r\nexport function handleResponseWithLoginCheck() {\r\n  axios.interceptors.response.use(\r\n    (response) => response,\r\n    (error) => {\r\n      const currentUser = useSelector((state: any) => state.user);\r\n      const isSignedIn = currentUser?.jwtAccessToken;\r\n      const status = error?.response?.status;\r\n\r\n      if (isSignedIn && [401, 403].includes(status)) {\r\n        appStore.dispatch(clearCurrentUser());\r\n        sessionHistory.push(\"/login\");\r\n      }\r\n      return Promise.reject(error);\r\n    }\r\n  );\r\n}\r\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,cAAc,QAAQ,oBAAoB;AACnD,SAEEC,gBAAgB,QACX,qDAAqD;AAC5D,OAAOC,QAAQ,MAAM,uCAAuC;AAC5D,SAASC,WAAW,QAAQ,aAAa;AAEzC,OAAO,MAAMC,UAAU,GAAG,MAAM;EAAA;EAC9B,MAAMC,iBAAiB,GAAGF,WAAW,CAAEG,KAAU,IAAKA,KAAK,CAACC,IAAI,CAAC;EAEjE,OAAO;IACL,cAAc,EAAE,kBAAkB;IAClCC,aAAa,EAAE,SAAS,IAAGH,iBAAiB,aAAjBA,iBAAiB,uBAAjBA,iBAAiB,CAAEI,cAAc;EAC9D,CAAC;AACH,CAAC;AAAC,GAPWL,UAAU;EAAA,QACKD,WAAW;AAAA;AAAA,KAD1BC,UAAU;AASvB,IAAIM,MAAmB;AAEvB,OAAO,SAASC,4BAA4B,GAAG;EAAA;EAC7C,IAAAZ,KAAK,CAACa,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC5BD,QAAQ,IAAKA,QAAQ,MACrBE,KAAK,IAAK;IAAA;IAAA;IACT,MAAMC,WAAW,GAAGb,WAAW,CAAEG,KAAU,IAAKA,KAAK,CAACC,IAAI,CAAC;IAC3D,MAAMU,UAAU,GAAGD,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEP,cAAc;IAC9C,MAAMS,MAAM,GAAGH,KAAK,aAALA,KAAK,0CAALA,KAAK,CAAEF,QAAQ,oDAAf,gBAAiBK,MAAM;IAEtC,IAAID,UAAU,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAACE,QAAQ,CAACD,MAAM,CAAC,EAAE;MAC7ChB,QAAQ,CAACkB,QAAQ,CAACnB,gBAAgB,EAAE,CAAC;MACrCD,cAAc,CAACqB,IAAI,CAAC,QAAQ,CAAC;IAC/B;IACA,OAAOC,OAAO,CAACC,MAAM,CAACR,KAAK,CAAC;EAC9B,CAAC;IAAA,QATqBZ,WAAW;EAAA,GAUlC;IAAA,QAVuBA,WAAW;EAAA;AAWrC;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}